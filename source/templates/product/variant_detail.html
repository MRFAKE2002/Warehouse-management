{% extends "product/base.html" %}
{% load static %}
{% load humanize %}
{% load jalali_tags %}

{% block content%}
{% comment %} 
<section class="content-header"> 
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6">
          <h1>{{object.title}}</h1>
        </div>
        <div class="col-sm-6">
    
        </div>
      </div>
    </div>
  </section>
 <section class="content" style="float:right;">

    <!-- Default box -->
    <div class="card">
      <div class="card-header">
        

        <div class="card-tools">
          <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
            <i class="fas fa-minus"></i></button>
        </div>
      </div>
      <div class="card-body" style="display: block;">
        <div class="row">
          <div class="col-12 col-md-12 col-lg-8 order-2 order-md-1">
            <div class="row">
              <div class="col-8 col-sm-6">
                <div class="info-box bg-light">
                  <div class="info-box-content">
                    <span class="info-box-text text-center text-muted">شناسه</span>
                    <span class="info-box-number text-center text-muted mb-0">{{object.id}}</span>
                  </div>
                </div>
              </div>
              <div class="col-8 col-sm-6">
                <div class="info-box bg-light">
                  <div class="info-box-content">
                    <span class="info-box-text text-center text-muted">دسته</span>
                    <span class="info-box-number text-center text-muted mb-0">{{object.category}}</span>
                  </div>
                </div>
              </div>
              <div class="col-8 col-sm-6">
                <div class="info-box bg-light">
                  <div class="info-box-content">
                    <span class="info-box-text text-center text-muted">رنگ</span>
                    <span class="info-box-number text-center text-muted mb-0">{{object.type}}</span>
                  </div>
                </div>
              </div>
              <div class="col-8 col-sm-6">
                <div class="info-box bg-light">
                  <div class="info-box-content">
                    <span class="info-box-text text-center text-muted">سایز</span>
                    <span class="info-box-number text-center text-muted mb-0">{{object.size}}</span>
                  </div>
                </div>
              </div>
              <div class="col-8 col-sm-6">
                <div class="info-box bg-light">
                  <div class="info-box-content">
                    <span class="info-box-text text-center text-muted">تعداد</span>
                    <span class="info-box-number text-center text-muted mb-0">{{object.count}}</span>
                  </div>
                </div>
              </div>
              <div class="col-8 col-sm-6">
                <div class="info-box bg-light">
                  <div class="info-box-content">
                    <span class="info-box-text text-center text-muted">توضیحی درباره محصول</span>
                    <span class="info-box-number text-center text-muted mb-0">{{object.supply.description}}</span>
                  </div>
                </div>
              </div>
              <div class="col-12 col-sm-12">
                <div class="info-box bg-light">
                  <div class="info-box-content">
                    <span class="info-box-text text-center text-muted">تصویر محصول</span>
                    <span class="info-box-number text-center text-muted mb-0">
                        <img src="{{object.supply.image.url}}" alt="{{object.title}}" class=" img-size-50 mr-2"></span>
               </div>

               <form method="post" action="{% url 'cart:add' %}">
                {% csrf_token %}
                  <input style="display:none;" name="variant_id", value="{{object.id}}">
                  <input name="quantity" type="number">
                  <button class="btn btn-success" type="submit">افزودن به لیست</button>
                </form>
                <a  class="btn btn-warning" href="{% url 'product:variant_update' object.id %}">
                  ویرایش
                </a>
             
                <a  class="btn btn-danger" href="{% url 'product:variant_update' object.id %}">
                  حذف
                </a>
               
              
          </div>
         
      <!-- /.card-body -->
    </div>
    <!-- /.card -->

</section> {% endcomment %}

<div class="row" style="padding-right:25px; padding-left:25px;">
  <div class="col-md-8" style="width: 50%; margin: auto;">
    <!-- Box Comment -->
    <div class="card card-widget">
      <div class="card-header">
        <div class="user-block">
          
          <span class="username">{{object.supply.title}}</span>
          <span class="description">{{object.supply.category_to_str}}</span>
        </div>
        <!-- /.user-block -->
        <div class="card-tools">
          <button type="button" class="btn btn-tool"><i></i>
            <a  class="fas fa-times" href="{% url 'product:variant_delete' object.id %}" style="margin-right:25px; color:red;">
            </a>
          </button>
          <button type="button" class="btn btn-tool">
            <a  class="fas fa-edit" href="{% url 'product:variant_update' object.id %}" style="color:orange;">
            </a>
          </button>
         
        </div>
        <!-- /.card-tools -->
      </div>
      <!-- /.card-header -->
      <div class="card-body" style="display: block;">
        <img class="img-fluid pad" src="{{object.supply.image.url}}" alt="Photo" style="padding-bottom: 25px;">

        <p>{{object.supply.description}}</p>

      </div>
      <!-- /.card-body -->
      <div class="card-footer card-comments" style="display: block;">
        <div class="info-box">
          <span class="info-box-icon bg-success"><i class="far fa-star"></i></span>

          <div class="info-box-content">
            <span class="info-box-text"> مدل موجود</span>
            <span class="info-box-number">{{object.type}}</span>
          </div>
          <!-- /.info-box-content -->
        </div>
        <div class="info-box">
          <span class="info-box-icon bg-success"><i class="far fa-star"></i></span>

          <div class="info-box-content">
            <span class="info-box-text">سایز موجود </span>
            <span class="info-box-number">{{object.size}}</span>
          </div>
          <!-- /.info-box-content -->
        </div>
        <div class="info-box">
          <span class="info-box-icon bg-success"><i class="far fa-star"></i></span>
          <div class="info-box-content">
            <span class="info-box-text">تعداد </span>
            <span class="info-box-number">{{object.inventory}}</span>
          </div>
          <!-- /.info-box-content -->
        </div>
        <div class="info-box">
          <span class="info-box-icon bg-success"><i class="far fa-star"></i></span>
          <div class="info-box-content">
            <span class="info-box-text">قیمت </span>
            <span class="info-box-number">{{object.price|intcomma:False}}</span>
          </div>
          <!-- /.info-box-content -->
        </div>
        <form method="post" action="{% url 'cart:add' %}">
          {% csrf_token %}

          <div class="info-box-content" style="padding-bottom:15px;">
            <span class="info-box-text" > تــعــداد </span>
            <input class="info-box-number" type="number" name="quantity">
          </div>
          <div class="info-box-content" style="padding-bottom:15px;">
            <button class="btn btn-success" type="submit">افزودن به لیست</button>
            <input style="display:none;" name="variant_id" value={{object.id}}>
          </div> 
        </form>    
      </div>
      <!-- /.card-footer -->
      {% for order in order_items %}
        <div class="card">
          <h3 class="card-title" style="float:right">سفارش شماره{{ order.order.id}}</h3>
          <div class="card-header">
            
            {% if order.order.customer_name and order.order.customer_phone_number %}
              <h4 class="card-title" style="float:right">{{ order.order.customer_name }}</h4>    
              <h4 class="card-title" style="float:right">{{ order.order.customer_phone_number }}</h4>
            {% elif not order.order.customer_phone_number and order.order.customer_name %}
              <h4 class="card-title" style="float:right">{{ order.order.customer_name }}</h4>    
            {% elif not order.order.customer_name and order.order.customer_phone_number %}
              <h4 class="card-title" style="float:right">{{ order.order.customer_phone_number }}</h4>
            {% elif not order.order.customer_phone_number and not order.order.customer_name %}
              مشتری گذری بوده
            {% endif %}
          </div>
          <!-- /.card-header -->
          <div class="card-body">
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>
                    حذف
                  </th>
                  <th style="width: 10px">ردیف</th>
                  <th>عنوان</th>
                  <th>مدل</th>
                  <th>سایز</th>
                  <th>قیمت</th>
                  <th>تعداد</th>
                  <th>قیمت کل</th>
                  <th>تاریخ و ساعت</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>            
                    <a class="fas fa-trash-alt" href="{% url 'order:remove' order.order.id order.id %}"></a>
                  </td>
                  <td>{% if order.id %}{{ order.id }}{% else %}هیچی{% endif %}</td>
                  <td>{% if order.variant.supply.title %}{{ order.variant.supply.title }}{% else %}هیچی{% endif %}</td>
                  <td>{% if order.variant.type.name %}{{ order.variant.type.name }}{% else %}هیچی{% endif %}</td>
                  <td>{% if order.variant.size.name %}{{ order.variant.size.name }}{% else %}هیچی{% endif %}</td>
                  <td>{{ order.price|intcomma:False }} تومان</td>
                  <td>{% if order.quantity %}{{ order.quantity }}{% else %}0{% endif %}</td>
                  <td>{{ order.total_price|intcomma:False }} تومان</td>
                  <td>{{ order.order.create_at|to_jalali:"%y/%m/%d _ %H:%M:%S" }}</td>
                </tr>
              </tbody>
            </table>
            <a href="{% url 'order:clear' order.order.id %}">پاک کردن سفارش</a>
          </div>
          <!-- /.card-body -->
          <div class="card-footer clearfix">
          </div>
        </div>
      {% endfor %}
      <div class="card-footer" style="display: block;">
       
          <div class="img-push">
            
          </div>
       
      </div>
      <!-- /.card-footer -->
    </div>
    <!-- /.card -->
  </div>
</div>

{% endblock %}
